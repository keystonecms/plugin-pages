{% extends "@pages/admin/_edit-layout.twig" %}

{% block styles %}
<input type="hidden" name="content_mode" value="richtext">

<link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
<style>
    .ql-editor {
        min-height: 320px;
    }
</style>
{% endblock %}

{% block editor %}
<div class="card">
    <div class="card-body">
        <div id="quill-editor">
            {{ page.content_html | raw }}
        </div>

      <textarea
        name="content_html"
        class="d-none"
      ></textarea>

    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
<script>
    window.PAGE_ID = {{ page.id }};
</script>
<script src="/assets/js/multiform-ajax.js"></script>
<script src="/assets/js/admin-page-common.js"></script>
<script src="/assets/js/admin-page-richtext.js"></script>
<!-- <script>
(function () {

    const quill = new Quill('#quill-editor', {
        theme: 'snow',
        modules: {
            toolbar: [
                ['bold', 'italic', 'underline'],
                [{ header: [2, 3, false] }],
                [{ list: 'ordered' }, { list: 'bullet' }],
                ['blockquote'],
                ['image'],
                ['code'],
                ['clean']
            ]
        }
    });

    /* Media picker integration */
    const toolbar = quill.getModule('toolbar');
    toolbar.addHandler('image', function () {
        window.open(
            '/admin/media?picker=1',
            'mediaPicker',
            'width=900,height=600'
        );
    });

    /* sync quill â†’ textarea before AJAX submit */
    $('form[id*=form]').on('submit', function () {
        $('textarea[name=content_html]').val(
            quill.root.innerHTML
        );
    });

    /* exposed for media picker */
    window.insertImage = function (url) {
        const range = quill.getSelection(true);
        quill.insertEmbed(range.index, 'image', url);
        quill.formatText(range.index, 1, 'alt', '');
        quill.setSelection(range.index + 1);
    };

})();
</script> -->
{% endblock %}